<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Copyright (c) 2016 Hieu Nguyen alright reserve
  -->

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="gmail.contract.dao.EventMapper">
	<insert id="insertEvent" parameterType="Event" useGeneratedKeys="true" keyProperty="dtoEvent.eventId">
		INSERT INTO `event`
		(
			`eventTitle`,
			`eventDescription`,
			`eventDetail`,
			`eventStartDate`,
			`eventEndDate`,
			`eventLocation`,
			`eventAddress`,
			`createdDate`,
			`lastUpdate`)
		VALUES
			(#{dtoEvent.eventTitle},
			 #{dtoEvent.eventDescription},
			 #{dtoEvent.eventDetail},
			 #{dtoEvent.eventStartDate},
			 #{dtoEvent.eventEndDate},
			 #{dtoEvent.eventLocation},
			 #{dtoEvent.eventAddress},
			 #{dtoEvent.createdDate},
			 #{dtoEvent.lastUpdate});
	</insert>

	<select id="findEventById" resultType="Event" parameterType="long">
		SELECT *
		FROM event e
		WHERE e.eventId = #{eventId};
	</select>

	<select id="getYearHaveEvent" resultType="String">
		SELECT YEAR(e.eventStartDate) AS year
		FROM
			event e
		GROUP BY YEAR(e.eventStartDate) DESC
	</select>

	<select id="getMonthsHaveEventByYear" resultType="String" parameterType="String">
		SELECT MONTH(e.eventStartDate) AS month
		FROM
			event e
		WHERE YEAR(e.eventStartDate) = #{year}
		GROUP BY MONTH(e.eventStartDate) DESC;
	</select>

	<select id="getEventsByYearMonth" resultType="Event" parameterType="String">
		SELECT e.*
		FROM
			event e
		WHERE YEAR(e.eventStartDate) = #{year} AND MONTH(e.eventStartDate) = #{month}
		GROUP BY e.eventStartDate ASC;
	</select>
</mapper>